<section data-ng-controller="IndexController" >
	
	<!-- Index de l'admin  -->
	<div class='row'>
		<div ng-show='global.isAdmin'>
			<form role="form" class="form-inline col-md-4 col-md-offset-3" name='formulaire'>
				<input type='text' ng-model='refMedia' placeholder='CodeBarre ou ref' ng-focus autofocus class='form-control' required ng-change="verifInput()">
				<!-- affichage en fonction du media trouvé -->
				<a ng-if='!newlivre.emprunt.user && newlivre' type='submit' ng-href="/#!/livres/{{newlivre._id}}/emprunt" class="btn btn-primary btn-sm"> emprunter</a> 
				<button ng-if='!newlivre.emprunt.user && !newlivre' type='submit' class="btn btn-primary btn-sm"> emprunter</button> 
				<button ng-if='newlivre.emprunt.user' type='submit' ng-click='rendreLivre(newlivre)' class="btn btn-primary btn-sm"><i class="glyphicon glyphicon-book"></i> Rendre</button>
			</form>
			<!-- affichage du livre trouvé -->
		</div>
	</div>
	<h1 data-ng-show='global.isAdmin'>Liste des utilisateurs actifs</h1>
	<div class='row'>
		<br/>
		<div data-ng-show='global.isAdmin' class='col-md-5 well' >
			<div class='col-md-9'>
				<input type='text' ng-model='searchUser' placeholder='Recherche' class='form-control'>
			</div>
			<br/>
			<br/>
			<br/>
			<div class="form-group">
				<label class='control-label col-md-10 lato-font' style='text-align:right; font-size:20px'> Afficher les inactifs : </label>
				<div class='col-md-2'>
					<input type='checkbox' class='form-control' ng-model='listeAll'>
				</div>
			</div>
			<br/>
			<br/>
			<ul style='list-style-type:none;'>
				<li class="users_list" ng-repeat="user in users | orderBy:['name', 'name'] | filter:searchUser" ng-if='checkActif(user)'>
					<a data-ng-href="#!/admin/users/{{user._id}}" ng-bind='user.name'></a>
				</li>
			</ul>
		</div>
		<article class='col-md-4 col-md-offset-2'>
			<h2 ng-show="newlivre" > Livre trouvé </h2>
			<a data-ng-href="#!/livres/{{newlivre._id}}">{{newlivre.title}}</a>
			<div data-ng-hide="!newlivre.lien_image"><a data-ng-href="#!/livres/{{newlivre._id}}"><img ng-src="{{newlivre.lien_image}}" border="0" align="center" width=80 height=130> </a>
				<span ng-show='emprunteur'> emprunté par {{emprunteur.name}} </span>
			</div>
			<div ng-show="newlivre"> {{newlivre.auteur}} Genre:{{newlivre.dewey}} Ref. {{newlivre.ref}}
			</div>
		</article>
	</div>

	<!-- Index utilisateur normal -->
	<div data-ng-hide='global.isAdmin'>
		<article>
			<h1> Bienvenue sur l'application de la médiathèque du CAES</h1>
			<!-- Si pas connecté -->
			<div data-ng-hide='global.authenticated' class='well'>
				<h3>  Pour accèder à la liste des médias ou a votre compte, connectez vous ! </h3>
				<p>
				<br/>
					La bibliothèque est située au local du CAES à l'INIST (bâtiment COSMOS), sur le trajet du restaurant - 2, allée du Parc de Brabois à Vandoeuvre. 
				</p>
				<p>
					Elle est ouverte les
					<h3> MARDI & VENDREDI de 12 h 30 à 13 h 30 </h3>
				<p>
				<p>
					Les modalités d'emprunt sont les suivantes : 
					<ul>
						<li>
							cotisation de 10 Euros/an pour une seule inscription Bibliothèque (sur laquelle sont appliqués les tarifs dégressifs detail des tarifs)
						</li>
						<li> dépôt d'une caution de 45 Euros </li> 
						<li> remplir le dossier du CAES (si ce n'est pas déjà fait !) </li>
					</ul>
					Vous pouvez emprunter :
					<ul>
						<li> 3 livres / mois </li>
						<li> 3 magazines / semaine </li>
						<li> 3 BD / semaine </li>
					</ul>
				</p>
				<p style='text-align: justify'>
					parmi un choix de plus de 2580 livres et 2900 B.D. (romans, policiers, science-fiction, livres sur la Lorraine, histoire...) et 12 revues auxquelles la bibliothèque est abonnée.
					liste des revues
					Chaque année, 2 à 3 achats de livres et de B.D. sont faits en fonction des demandes des adhérents. N'hésitez pas à faire vos suggestions auprès des bénévoles

					Le budget de fonctionnement de l'activité correspond à une subvention annuelle votée par les élus du CLAS à laquelle s'ajoute l'argent recueilli par les cotisations des adhérents de l'activité.
				</p>
				<br/>
			</div>

			<!-- si connecté -->
			<div data-ng-show='global.authenticated'>
				<p>
					il y a {{livre_dispo}} livres disponible dans la médiathèque !
				</p>
				<article class="col-md-8">
					<h4> Liste de vos emprunts en cours : </h4>
					<ul>
						<li class="user_list" ng-repeat="media in listeEmprunt">
							<a data-ng-href="#!/livres/{{media._id}}">{{media.title}}</a>
							<div data-ng-hide="!media.lien_image"><a data-ng-href="#!/livres/{{media._id}}"><img ng-src="{{media.lien_image}}" border="0" align="center" width=80 height=130> </a></div>
							<p> {{media.auteur}}&nbsp&nbsp&nbsp&nbsp&nbsp Genre:{{media.dewey}} &nbsp Ref. {{media.ref}}</p>
							<p ng-show="media.emprunt.date_fin" ng-bind='date_diff(media)'> </p>
						</li>
					</ul>
					<p ng-show='listeEmprunt.length === 0'>
						Aucun emprunt en cours
					</p>
				</article>
			</div>
		</article>
	</div>
</section>
